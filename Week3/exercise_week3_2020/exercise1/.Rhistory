#Convergence ~ between 30 and 40
# distribution
library(rstan)                       # First, load the necessary tool - that is Rhat function
# ?Rhat
THETA = rbind(theta1,theta2,theta3)  # Put the chains into list where each row is one Markov chain
paste(Rhat(THETA))
# if Rhat value is greater than 1.05 try to remove more samples from the beginning
# However, note that you may need to increase the sample size in order to get reliable estimate for PSRF
# Note also that the Rhat values change each time you rerun the Markov chains. Hence, even if with one
# realization the PSRF looked fine it might not be so in another even with same number of samples.
# Define the sample size
m = 100
# sample from three independent Markov chains as instructed in the exercise
theta1 = Sampling (10,0.894472,0.2 )
theta2 = Sampling (-10,0.894472,0.2 )
theta3 = Sampling (5,0.894472,0.2 )
# examine the chains visually
plot(theta1, type="l", xlab="iteration", ylab=expression(theta), main=sprintf("sigma2=%.1f, phi=%.2f", 0.2,0.89), ylim=c(-10,10))
lines(theta2, col="blue")
lines(theta3, col="red")
# Check visually where the sample chains seem to have converged to the same stationary
#Convergence ~ between 30 and 40
# distribution
library(rstan)                       # First, load the necessary tool - that is Rhat function
# ?Rhat
THETA = rbind(theta1,theta2,theta3)  # Put the chains into list where each row is one Markov chain
paste(Rhat(THETA))
# if Rhat value is greater than 1.05 try to remove more samples from the beginning
# However, note that you may need to increase the sample size in order to get reliable estimate for PSRF
# Note also that the Rhat values change each time you rerun the Markov chains. Hence, even if with one
# realization the PSRF looked fine it might not be so in another even with same number of samples.
# Define the sample size
m = 100
# sample from three independent Markov chains as instructed in the exercise
theta1 = Sampling (10,0.894472,0.2 )
theta2 = Sampling (-10,0.894472,0.2 )
theta3 = Sampling (5,0.894472,0.2 )
# examine the chains visually
plot(theta1, type="l", xlab="iteration", ylab=expression(theta), main=sprintf("sigma2=%.1f, phi=%.2f", 0.2,0.89), ylim=c(-10,10))
lines(theta2, col="blue")
lines(theta3, col="red")
# Check visually where the sample chains seem to have converged to the same stationary
#Convergence ~ between 30 and 40
# distribution
library(rstan)                       # First, load the necessary tool - that is Rhat function
# ?Rhat
THETA = rbind(theta1,theta2,theta3)  # Put the chains into list where each row is one Markov chain
paste(Rhat(THETA))
# if Rhat value is greater than 1.05 try to remove more samples from the beginning
# However, note that you may need to increase the sample size in order to get reliable estimate for PSRF
# Note also that the Rhat values change each time you rerun the Markov chains. Hence, even if with one
# realization the PSRF looked fine it might not be so in another even with same number of samples.
# Define the sample size
m = 100
# sample from three independent Markov chains as instructed in the exercise
theta1 = Sampling (10,0.894472,0.2 )
theta2 = Sampling (-10,0.894472,0.2 )
theta3 = Sampling (5,0.894472,0.2 )
# examine the chains visually
plot(theta1, type="l", xlab="iteration", ylab=expression(theta), main=sprintf("sigma2=%.1f, phi=%.2f", 0.2,0.89), ylim=c(-10,10))
lines(theta2, col="blue")
lines(theta3, col="red")
# Check visually where the sample chains seem to have converged to the same stationary
#Convergence ~ between 30 and 40
# distribution
library(rstan)                       # First, load the necessary tool - that is Rhat function
# ?Rhat
THETA = rbind(theta1,theta2,theta3)  # Put the chains into list where each row is one Markov chain
paste(Rhat(THETA))
# if Rhat value is greater than 1.05 try to remove more samples from the beginning
# However, note that you may need to increase the sample size in order to get reliable estimate for PSRF
# Note also that the Rhat values change each time you rerun the Markov chains. Hence, even if with one
# realization the PSRF looked fine it might not be so in another even with same number of samples.
# Define the sample size
m = 100
# sample from three independent Markov chains as instructed in the exercise
theta1 = Sampling (10,0.894472,0.2 )
theta2 = Sampling (-10,0.894472,0.2 )
theta3 = Sampling (5,0.894472,0.2 )
# examine the chains visually
plot(theta1, type="l", xlab="iteration", ylab=expression(theta), main=sprintf("sigma2=%.1f, phi=%.2f", 0.2,0.89), ylim=c(-10,10))
lines(theta2, col="blue")
lines(theta3, col="red")
# Check visually where the sample chains seem to have converged to the same stationary
#Convergence ~ between 30 and 40
# distribution
library(rstan)                       # First, load the necessary tool - that is Rhat function
# ?Rhat
THETA = rbind(theta1,theta2,theta3)  # Put the chains into list where each row is one Markov chain
paste(Rhat(THETA))
# if Rhat value is greater than 1.05 try to remove more samples from the beginning
# However, note that you may need to increase the sample size in order to get reliable estimate for PSRF
# Note also that the Rhat values change each time you rerun the Markov chains. Hence, even if with one
# realization the PSRF looked fine it might not be so in another even with same number of samples.
# Define the sample size
m = 100
# sample from three independent Markov chains as instructed in the exercise
theta1 = Sampling (10,0.894472,0.2 )
theta2 = Sampling (-10,0.894472,0.2 )
theta3 = Sampling (5,0.894472,0.2 )
# examine the chains visually
plot(theta1, type="l", xlab="iteration", ylab=expression(theta), main=sprintf("sigma2=%.1f, phi=%.2f", 0.2,0.89), ylim=c(-10,10))
lines(theta2, col="blue")
lines(theta3, col="red")
# Check visually where the sample chains seem to have converged to the same stationary
#Convergence ~ between 30 and 40
# distribution
library(rstan)                       # First, load the necessary tool - that is Rhat function
# ?Rhat
THETA = rbind(theta1,theta2,theta3)  # Put the chains into list where each row is one Markov chain
paste(Rhat(THETA))
# if Rhat value is greater than 1.05 try to remove more samples from the beginning
# However, note that you may need to increase the sample size in order to get reliable estimate for PSRF
# Note also that the Rhat values change each time you rerun the Markov chains. Hence, even if with one
# realization the PSRF looked fine it might not be so in another even with same number of samples.
# Define the sample size
m = 100
# sample from three independent Markov chains as instructed in the exercise
theta1 = Sampling (10,0.894472,0.2 )
theta2 = Sampling (-10,0.894472,0.2 )
theta3 = Sampling (5,0.894472,0.2 )
# examine the chains visually
plot(theta1, type="l", xlab="iteration", ylab=expression(theta), main=sprintf("sigma2=%.1f, phi=%.2f", 0.2,0.89), ylim=c(-10,10))
lines(theta2, col="blue")
lines(theta3, col="red")
# Check visually where the sample chains seem to have converged to the same stationary
#Convergence ~ between 30 and 40
# distribution
library(rstan)                       # First, load the necessary tool - that is Rhat function
# ?Rhat
THETA = rbind(theta1,theta2,theta3)  # Put the chains into list where each row is one Markov chain
paste(Rhat(THETA))
# if Rhat value is greater than 1.05 try to remove more samples from the beginning
# However, note that you may need to increase the sample size in order to get reliable estimate for PSRF
# Note also that the Rhat values change each time you rerun the Markov chains. Hence, even if with one
# realization the PSRF looked fine it might not be so in another even with same number of samples.
M = 100
# let's first define a function to conduct the sampling
Sampling = function(initial_value,Phi,Sigma2,m) {
C=initial_value
Theta = rep(0,100)
Theta[1] = C
for(i in 2:m)
Theta[i] = rnorm(1,Phi * Theta[i-1] , sqrt(Sigma2))
return(Theta)
}
# Then we sample from the Markov chain with alternative phi and sigma values and draw them
ThetaSerie1 = Sampling (10,0,1,M)
ThetaSerie2 = Sampling (10,0.5,0.75,M )
ThetaSerie3 = Sampling (10,0.894472,0.2,M )
ThetaSerie4 = Sampling (10,0.1,0.99,M )
plot(1:100,ThetaSerie1,type='l',col=1)
lines(1:100,ThetaSerie2,col=2)
lines(1:100,ThetaSerie3,col=3)
lines(1:100,ThetaSerie4,col=4)
# Define the sample size
m = 1000
# sample from three independent Markov chains as instructed in the exercise
theta1 = Sampling (10,0.894472,0.2,m )
theta2 = Sampling (-10,0.894472,0.2,m )
theta3 = Sampling (5,0.894472,0.2,m )
# examine the chains visually
plot(theta1, type="l", xlab="iteration", ylab=expression(theta), main=sprintf("sigma2=%.1f, phi=%.2f", 0.2,0.89), ylim=c(-10,10))
lines(theta2, col="blue")
lines(theta3, col="red")
# Check visually where the sample chains seem to have converged to the same stationary
#Convergence ~ between 30 and 40
# distribution
library(rstan)                       # First, load the necessary tool - that is Rhat function
# ?Rhat
THETA = rbind(theta1,theta2,theta3)  # Put the chains into list where each row is one Markov chain
paste(Rhat(THETA))
# if Rhat value is greater than 1.05 try to remove more samples from the beginning
# However, note that you may need to increase the sample size in order to get reliable estimate for PSRF
# Note also that the Rhat values change each time you rerun the Markov chains. Hence, even if with one
# realization the PSRF looked fine it might not be so in another even with same number of samples.
# Define the sample size
m = 1000
# sample from three independent Markov chains as instructed in the exercise
theta1 = Sampling (10,0.894472,0.2,m )
theta2 = Sampling (-10,0.894472,0.2,m )
theta3 = Sampling (5,0.894472,0.2,m )
# examine the chains visually
plot(theta1, type="l", xlab="iteration", ylab=expression(theta), main=sprintf("sigma2=%.1f, phi=%.2f", 0.2,0.89), ylim=c(-10,10))
lines(theta2, col="blue")
lines(theta3, col="red")
# Check visually where the sample chains seem to have converged to the same stationary
#Convergence ~ between 30 and 40
# distribution
library(rstan)                       # First, load the necessary tool - that is Rhat function
# ?Rhat
THETA = rbind(theta1,theta2,theta3)  # Put the chains into list where each row is one Markov chain
paste(Rhat(THETA))
# if Rhat value is greater than 1.05 try to remove more samples from the beginning
# However, note that you may need to increase the sample size in order to get reliable estimate for PSRF
# Note also that the Rhat values change each time you rerun the Markov chains. Hence, even if with one
# realization the PSRF looked fine it might not be so in another even with same number of samples.
# Define the sample size
m = 1000
# sample from three independent Markov chains as instructed in the exercise
theta1 = Sampling (10,0.894472,0.2,m )
theta2 = Sampling (-10,0.894472,0.2,m )
theta3 = Sampling (5,0.894472,0.2,m )
# examine the chains visually
plot(theta1, type="l", xlab="iteration", ylab=expression(theta), main=sprintf("sigma2=%.1f, phi=%.2f", 0.2,0.89), ylim=c(-10,10))
lines(theta2, col="blue")
lines(theta3, col="red")
# Check visually where the sample chains seem to have converged to the same stationary
#Convergence ~ between 30 and 40
# distribution
library(rstan)                       # First, load the necessary tool - that is Rhat function
# ?Rhat
THETA = rbind(theta1,theta2,theta3)  # Put the chains into list where each row is one Markov chain
paste(Rhat(THETA))
# if Rhat value is greater than 1.05 try to remove more samples from the beginning
# However, note that you may need to increase the sample size in order to get reliable estimate for PSRF
# Note also that the Rhat values change each time you rerun the Markov chains. Hence, even if with one
# realization the PSRF looked fine it might not be so in another even with same number of samples.
# Define the sample size
m = 1000
# sample from three independent Markov chains as instructed in the exercise
theta1 = Sampling (10,0.894472,0.2,m )
theta2 = Sampling (-10,0.894472,0.2,m )
theta3 = Sampling (5,0.894472,0.2,m )
# examine the chains visually
plot(theta1, type="l", xlab="iteration", ylab=expression(theta), main=sprintf("sigma2=%.1f, phi=%.2f", 0.2,0.89), ylim=c(-10,10))
lines(theta2, col="blue")
lines(theta3, col="red")
# Check visually where the sample chains seem to have converged to the same stationary
#Convergence ~ between 30 and 40
# distribution
library(rstan)                       # First, load the necessary tool - that is Rhat function
# ?Rhat
THETA = rbind(theta1,theta2,theta3)  # Put the chains into list where each row is one Markov chain
paste(Rhat(THETA))
# if Rhat value is greater than 1.05 try to remove more samples from the beginning
# However, note that you may need to increase the sample size in order to get reliable estimate for PSRF
# Note also that the Rhat values change each time you rerun the Markov chains. Hence, even if with one
# realization the PSRF looked fine it might not be so in another even with same number of samples.
# Define the sample size
m = 1000
# sample from three independent Markov chains as instructed in the exercise
theta1 = Sampling (10,0.894472,0.2,m )
theta2 = Sampling (-10,0.894472,0.2,m )
theta3 = Sampling (5,0.894472,0.2,m )
# examine the chains visually
plot(theta1, type="l", xlab="iteration", ylab=expression(theta), main=sprintf("sigma2=%.1f, phi=%.2f", 0.2,0.89), ylim=c(-10,10))
lines(theta2, col="blue")
lines(theta3, col="red")
# Check visually where the sample chains seem to have converged to the same stationary
#Convergence ~ between 30 and 40
# distribution
library(rstan)                       # First, load the necessary tool - that is Rhat function
# ?Rhat
THETA = rbind(theta1,theta2,theta3)  # Put the chains into list where each row is one Markov chain
paste(Rhat(THETA))
# if Rhat value is greater than 1.05 try to remove more samples from the beginning
# However, note that you may need to increase the sample size in order to get reliable estimate for PSRF
# Note also that the Rhat values change each time you rerun the Markov chains. Hence, even if with one
# realization the PSRF looked fine it might not be so in another even with same number of samples.
# Define the sample size
m = 1000
# sample from three independent Markov chains as instructed in the exercise
theta1 = Sampling (10,0.894472,0.2,m )
theta2 = Sampling (-10,0.894472,0.2,m )
theta3 = Sampling (5,0.894472,0.2,m )
# examine the chains visually
plot(theta1, type="l", xlab="iteration", ylab=expression(theta), main=sprintf("sigma2=%.1f, phi=%.2f", 0.2,0.89), ylim=c(-10,10))
lines(theta2, col="blue")
lines(theta3, col="red")
# Check visually where the sample chains seem to have converged to the same stationary
#Convergence ~ between 30 and 40
# distribution
library(rstan)                       # First, load the necessary tool - that is Rhat function
# ?Rhat
THETA = rbind(theta1,theta2,theta3)  # Put the chains into list where each row is one Markov chain
paste(Rhat(THETA))
# if Rhat value is greater than 1.05 try to remove more samples from the beginning
# However, note that you may need to increase the sample size in order to get reliable estimate for PSRF
# Note also that the Rhat values change each time you rerun the Markov chains. Hence, even if with one
# realization the PSRF looked fine it might not be so in another even with same number of samples.
# Define the sample size
m = 1000
# sample from three independent Markov chains as instructed in the exercise
theta1 = Sampling (10,0.894472,0.2,m )
theta2 = Sampling (-10,0.894472,0.2,m )
theta3 = Sampling (5,0.894472,0.2,m )
# examine the chains visually
plot(theta1, type="l", xlab="iteration", ylab=expression(theta), main=sprintf("sigma2=%.1f, phi=%.2f", 0.2,0.89), ylim=c(-10,10))
lines(theta2, col="blue")
lines(theta3, col="red")
# Check visually where the sample chains seem to have converged to the same stationary
#Convergence ~ between 30 and 40
# distribution
library(rstan)                       # First, load the necessary tool - that is Rhat function
# ?Rhat
THETA = rbind(theta1,theta2,theta3)  # Put the chains into list where each row is one Markov chain
paste(Rhat(THETA))
# if Rhat value is greater than 1.05 try to remove more samples from the beginning
# However, note that you may need to increase the sample size in order to get reliable estimate for PSRF
# Note also that the Rhat values change each time you rerun the Markov chains. Hence, even if with one
# realization the PSRF looked fine it might not be so in another even with same number of samples.
# Define the sample size
m = 1000
# sample from three independent Markov chains as instructed in the exercise
theta1 = Sampling (10,0.894472,0.2,m )
theta2 = Sampling (-10,0.894472,0.2,m )
theta3 = Sampling (5,0.894472,0.2,m )
# examine the chains visually
plot(theta1, type="l", xlab="iteration", ylab=expression(theta), main=sprintf("sigma2=%.1f, phi=%.2f", 0.2,0.89), ylim=c(-10,10))
lines(theta2, col="blue")
lines(theta3, col="red")
# Check visually where the sample chains seem to have converged to the same stationary
#Convergence ~ between 30 and 40
# distribution
library(rstan)                       # First, load the necessary tool - that is Rhat function
# ?Rhat
THETA = rbind(theta1,theta2,theta3)  # Put the chains into list where each row is one Markov chain
paste(Rhat(THETA))
# if Rhat value is greater than 1.05 try to remove more samples from the beginning
# However, note that you may need to increase the sample size in order to get reliable estimate for PSRF
# Note also that the Rhat values change each time you rerun the Markov chains. Hence, even if with one
# realization the PSRF looked fine it might not be so in another even with same number of samples.
# Define the sample size
m = 1000
# sample from three independent Markov chains as instructed in the exercise
theta1 = Sampling (10,0.894472,0.2,m )
theta2 = Sampling (-10,0.894472,0.2,m )
theta3 = Sampling (5,0.894472,0.2,m )
# examine the chains visually
plot(theta1, type="l", xlab="iteration", ylab=expression(theta), main=sprintf("sigma2=%.1f, phi=%.2f", 0.2,0.89), ylim=c(-10,10))
lines(theta2, col="blue")
lines(theta3, col="red")
# Check visually where the sample chains seem to have converged to the same stationary
#Convergence ~ between 30 and 40
# distribution
library(rstan)                       # First, load the necessary tool - that is Rhat function
# ?Rhat
THETA = rbind(theta1,theta2,theta3)  # Put the chains into list where each row is one Markov chain
paste(Rhat(THETA))
# if Rhat value is greater than 1.05 try to remove more samples from the beginning
# However, note that you may need to increase the sample size in order to get reliable estimate for PSRF
# Note also that the Rhat values change each time you rerun the Markov chains. Hence, even if with one
# realization the PSRF looked fine it might not be so in another even with same number of samples.
# Define the sample size
m = 1000
# sample from three independent Markov chains as instructed in the exercise
theta1 = Sampling (10,0.894472,0.2,m )
theta2 = Sampling (-10,0.894472,0.2,m )
theta3 = Sampling (5,0.894472,0.2,m )
# examine the chains visually
plot(theta1, type="l", xlab="iteration", ylab=expression(theta), main=sprintf("sigma2=%.1f, phi=%.2f", 0.2,0.89), ylim=c(-10,10))
lines(theta2, col="blue")
lines(theta3, col="red")
# Check visually where the sample chains seem to have converged to the same stationary
#Convergence ~ between 30 and 40
# distribution
library(rstan)                       # First, load the necessary tool - that is Rhat function
# ?Rhat
THETA = rbind(theta1,theta2,theta3)  # Put the chains into list where each row is one Markov chain
paste(Rhat(THETA))
# if Rhat value is greater than 1.05 try to remove more samples from the beginning
# However, note that you may need to increase the sample size in order to get reliable estimate for PSRF
# Note also that the Rhat values change each time you rerun the Markov chains. Hence, even if with one
# realization the PSRF looked fine it might not be so in another even with same number of samples.
# Define the sample size
m = 1000
# sample from three independent Markov chains as instructed in the exercise
theta1 = Sampling (10,0.894472,0.2,m )
theta2 = Sampling (-10,0.894472,0.2,m )
theta3 = Sampling (5,0.894472,0.2,m )
# examine the chains visually
plot(theta1, type="l", xlab="iteration", ylab=expression(theta), main=sprintf("sigma2=%.1f, phi=%.2f", 0.2,0.89), ylim=c(-10,10))
lines(theta2, col="blue")
lines(theta3, col="red")
# Check visually where the sample chains seem to have converged to the same stationary
#Convergence ~ between 30 and 40
# distribution
library(rstan)                       # First, load the necessary tool - that is Rhat function
# ?Rhat
THETA = rbind(theta1,theta2,theta3)  # Put the chains into list where each row is one Markov chain
paste(Rhat(THETA))
# if Rhat value is greater than 1.05 try to remove more samples from the beginning
# However, note that you may need to increase the sample size in order to get reliable estimate for PSRF
# Note also that the Rhat values change each time you rerun the Markov chains. Hence, even if with one
# realization the PSRF looked fine it might not be so in another even with same number of samples.
# Define the sample size
m = 1000
# sample from three independent Markov chains as instructed in the exercise
theta1 = Sampling (10,0.894472,0.2,m )
theta2 = Sampling (-10,0.894472,0.2,m )
theta3 = Sampling (5,0.894472,0.2,m )
# examine the chains visually
plot(theta1, type="l", xlab="iteration", ylab=expression(theta), main=sprintf("sigma2=%.1f, phi=%.2f", 0.2,0.89), ylim=c(-10,10))
lines(theta2, col="blue")
lines(theta3, col="red")
# Check visually where the sample chains seem to have converged to the same stationary
#Convergence ~ between 30 and 40
# distribution
library(rstan)                       # First, load the necessary tool - that is Rhat function
# ?Rhat
THETA = rbind(theta1,theta2,theta3)  # Put the chains into list where each row is one Markov chain
paste(Rhat(THETA))
# if Rhat value is greater than 1.05 try to remove more samples from the beginning
# However, note that you may need to increase the sample size in order to get reliable estimate for PSRF
# Note also that the Rhat values change each time you rerun the Markov chains. Hence, even if with one
# realization the PSRF looked fine it might not be so in another even with same number of samples.
# Define the sample size
m = 1000
# sample from three independent Markov chains as instructed in the exercise
theta1 = Sampling (10,0.894472,0.2,m )
theta2 = Sampling (-10,0.894472,0.2,m )
theta3 = Sampling (5,0.894472,0.2,m )
# examine the chains visually
plot(theta1, type="l", xlab="iteration", ylab=expression(theta), main=sprintf("sigma2=%.1f, phi=%.2f", 0.2,0.89), ylim=c(-10,10))
lines(theta2, col="blue")
lines(theta3, col="red")
# Check visually where the sample chains seem to have converged to the same stationary
#Convergence ~ between 30 and 40
# distribution
library(rstan)                       # First, load the necessary tool - that is Rhat function
# ?Rhat
THETA = rbind(theta1,theta2,theta3)  # Put the chains into list where each row is one Markov chain
paste(Rhat(THETA))
# if Rhat value is greater than 1.05 try to remove more samples from the beginning
# However, note that you may need to increase the sample size in order to get reliable estimate for PSRF
# Note also that the Rhat values change each time you rerun the Markov chains. Hence, even if with one
# realization the PSRF looked fine it might not be so in another even with same number of samples.
# Define the sample size
m = 1000
# sample from three independent Markov chains as instructed in the exercise
theta1 = Sampling (10,0.894472,0.2,m )
theta2 = Sampling (-10,0.894472,0.2,m )
theta3 = Sampling (5,0.894472,0.2,m )
# examine the chains visually
plot(theta1, type="l", xlab="iteration", ylab=expression(theta), main=sprintf("sigma2=%.1f, phi=%.2f", 0.2,0.89), ylim=c(-10,10))
lines(theta2, col="blue")
lines(theta3, col="red")
# Check visually where the sample chains seem to have converged to the same stationary
#Convergence ~ between 30 and 40
# distribution
library(rstan)                       # First, load the necessary tool - that is Rhat function
# ?Rhat
THETA = rbind(theta1,theta2,theta3)  # Put the chains into list where each row is one Markov chain
paste(Rhat(THETA))
# if Rhat value is greater than 1.05 try to remove more samples from the beginning
# However, note that you may need to increase the sample size in order to get reliable estimate for PSRF
# Note also that the Rhat values change each time you rerun the Markov chains. Hence, even if with one
# realization the PSRF looked fine it might not be so in another even with same number of samples.
# Define the sample size
m = 1000
# sample from three independent Markov chains as instructed in the exercise
theta1 = Sampling (10,0.894472,0.2,m )
theta2 = Sampling (-10,0.894472,0.2,m )
theta3 = Sampling (5,0.894472,0.2,m )
# examine the chains visually
plot(theta1, type="l", xlab="iteration", ylab=expression(theta), main=sprintf("sigma2=%.1f, phi=%.2f", 0.2,0.89), ylim=c(-10,10))
lines(theta2, col="blue")
lines(theta3, col="red")
# Check visually where the sample chains seem to have converged to the same stationary
#Convergence ~ between 30 and 40
# distribution
library(rstan)                       # First, load the necessary tool - that is Rhat function
# ?Rhat
THETA = rbind(theta1,theta2,theta3)  # Put the chains into list where each row is one Markov chain
paste(Rhat(THETA))
# if Rhat value is greater than 1.05 try to remove more samples from the beginning
# However, note that you may need to increase the sample size in order to get reliable estimate for PSRF
# Note also that the Rhat values change each time you rerun the Markov chains. Hence, even if with one
# realization the PSRF looked fine it might not be so in another even with same number of samples.
# Define the sample size
m = 100
# sample from three independent Markov chains as instructed in the exercise
theta1 = Sampling (10,0.894472,0.2,m )
theta2 = Sampling (-10,0.894472,0.2,m )
theta3 = Sampling (5,0.894472,0.2,m )
# examine the chains visually
plot(theta1, type="l", xlab="iteration", ylab=expression(theta), main=sprintf("sigma2=%.1f, phi=%.2f", 0.2,0.89), ylim=c(-10,10))
lines(theta2, col="blue")
lines(theta3, col="red")
# Check visually where the sample chains seem to have converged to the same stationary
#Convergence ~ between 30 and 40
# distribution
library(rstan)                       # First, load the necessary tool - that is Rhat function
# ?Rhat
THETA = rbind(theta1,theta2,theta3)  # Put the chains into list where each row is one Markov chain
paste(Rhat(THETA))
# if Rhat value is greater than 1.05 try to remove more samples from the beginning
# However, note that you may need to increase the sample size in order to get reliable estimate for PSRF
# Note also that the Rhat values change each time you rerun the Markov chains. Hence, even if with one
# realization the PSRF looked fine it might not be so in another even with same number of samples.
# Define the sample size
m = 1000
# sample from three independent Markov chains as instructed in the exercise
theta1 = Sampling (10,0.894472,0.2,m )
theta2 = Sampling (-10,0.894472,0.2,m )
theta3 = Sampling (5,0.894472,0.2,m )
# examine the chains visually
plot(theta1, type="l", xlab="iteration", ylab=expression(theta), main=sprintf("sigma2=%.1f, phi=%.2f", 0.2,0.89), ylim=c(-10,10))
lines(theta2, col="blue")
lines(theta3, col="red")
# Check visually where the sample chains seem to have converged to the same stationary
#Convergence ~ 20
# distribution
library(rstan)                       # First, load the necessary tool - that is Rhat function
# ?Rhat
THETA = rbind(theta1,theta2,theta3)  # Put the chains into list where each row is one Markov chain
paste(Rhat(THETA))
# if Rhat value is greater than 1.05 try to remove more samples from the beginning
# However, note that you may need to increase the sample size in order to get reliable estimate for PSRF
# Note also that the Rhat values change each time you rerun the Markov chains. Hence, even if with one
# realization the PSRF looked fine it might not be so in another even with same number of samples.
